import Intent from "android.content.Intent";
import JSONObject from "com.alibaba.fastjson.JSONObject";
import UniModule from "io.dcloud.feature.uniapp.common.UniModule";
import UniJSMethod from "io.dcloud.feature.uniapp.annotation.UniJSMethod";
import UniJSCallback from "io.dcloud.feature.uniapp.bridge.UniJSCallback";
import log from "./log";
export default class TestModule implements UniLogin {
  TAG = "TestModule";
  static REQUEST_CODE = 1000;
  //run ui thread
  @UniJSMethod({ uiThread: true })
  async testAsyncFunc(options: JSONObject, callback?: UniJSCallback) {
    log(this.TAG, "testAsyncFunc--$options");
    if (callback != null) {
      const data = new JSONObject();
      data["code"] = "success12312";
      callback.invoke(data);
    }
  }
  //run JS thread
  @UniJSMethod({ uiThread: false })
  testSyncFunc(options: JSONObject): JSONObject {
    const data = new JSONObject();
    data["code"] = "success456";
    return data;
  }
  override onActivityResult(requestCode: Int, resultCode: Int, data: Intent) {
    if (requestCode == TestModule.REQUEST_CODE && data.hasExtra("respond")) {
      log(this.TAG, "原生页面返回----" + data.getStringExtra("respond"));
    } else {
      super.onActivityResult(requestCode, resultCode, data);
    }
  }
}
